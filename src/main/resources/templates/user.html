<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/adminDashboardCss.css"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          crossorigin="anonymous"/>

    <title>User</title>
</head>
<body>

<div class = "container">
    <form th:action="@{/user}" method="POST" class="form-horizontal">
    </form>

    <br/><br/>

    <hr/>
    <a th:href="@{/createTicket}" class ="btn btn-primary" >Create Ticket âž•</a>
    <div class="dropdown">
        <button class="dropbtn"><img src="/images/filterButton.png"></button>
        <div class="dropdown-content">
            <a href="#">Status</a>
            <a href="#">Admin</a>
            <a href="#">User</a>
            <a href="#">Priorization</a>
            <a href="#">Incident</a>
        </div>
    </div>
    <div type="button" class="userbutton" ><img src="/images/userButton.png"></div>
    <div type="button" class="notification" ><img src="/images/notification.png"></div>
    <br/><br/>

    <table class="table table-bordered table-striped" id="ticketTable">
        <thead>
        <tr>
            <th data-type="string">Priorization</th>
            <th data-type="string">Incident</th>
            <th data-type="date">Date</th>
            <th data-type="string">Admin</th>
            <th data-type="string">Status</th>
        </tr>

        <tbody>
        <tr th:each="ticket: ${tickets}">
            <td class="col-md-1" th:text="${ticket.getPrio()}" />
            <td class="col-md-2" th:text="${ticket.getIncident()}" />
            <td class="col-md-3" th:text="${ticket.getDate()}" />
            <!--admin-Name?-->
            <td class="col-md-4" th:text="${ticket.getUser().getUsername()}" />
            <td class="col-md-5" th:text="${ticket.getStatus()}" />
        </tr>
        </tbody>
    </table>
</div>
</body>


<script type="text/javascript">
    // HTML-Tabelle sortieren

    const table = document.getElementById("foobar-table");
    const headers = table.querySelectorAll("th");
    const tableBody = table.querySelector("tbody");
    const rows = tableBody.querySelectorAll("tr");
    const directions = Array.from(headers).map(function (header) {
        return "";
    });

    const transform = function (index, content) {
        const type = headers[index].getAttribute("data-type");
        switch (type) {
            case "number":
                return parseFloat(content);
            case "string":
            default:
                return content;
        }
    };

    const sortColumn = function (index, headers) {

        const cls = ["upArrow", "dnArrow"];
        headers.forEach((header) => {
            document.getElementById(header.id).classList.remove(...cls);
        });

        const direction = directions[index] || "asc";
        const multiplier = (direction === "asc") ? 1 : -1;
        const newRows = Array.from(rows);

        if (direction === "asc") {
            document.getElementById(index).classList.add("upArrow");
        } else {
            document.getElementById(index).classList.add("dnArrow");
        }

        newRows.sort((rowA, rowB) => {
            const cellA = rowA.querySelectorAll("td")[index].textContent.toLowerCase();
            const cellB = rowB.querySelectorAll("td")[index].textContent.toLowerCase();

            const a = transform(index, cellA);
            const b = transform(index, cellB);

            switch (true) {
                case a > b:
                    return 1 * multiplier;
                case a < b:
                    return -1 * multiplier;
                case a === b:
                    return 0;
            }
        });

        [].forEach.call(rows, function (row) {
            tableBody.removeChild(row);
        });

        directions[index] = direction === "asc" ? "desc" : "asc";
        newRows.forEach(function (newRow) {
            tableBody.appendChild(newRow);
        });
    };

    [].forEach.call(headers, function (header, index) {
        header.setAttribute("id", index);
        header.addEventListener("click", () => {
            sortColumn(index, headers);
        });
    });
</script>
</html>

<style>* {
    box-sizing: border-box;
}


body {
    position: center;
    margin: 0 auto;
    background-color: white;
    text-align: left;
}


.dnArrow::after {
    content: "\2193";
    color: #FFFFFF;
    position: absolute;
}



.dropdown-content a {
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown-content a:hover {
    background-color: #ddd;
}

.dropdown:hover .dropdown-content {
    display: block;
}

.dropdown:hover .dropbtn {
    background-color: white;
}
table#foobar-table {
    margin-left: 50px;
}

table#foobar-table thead {
    position: sticky;
    inset-block-start: 0;
    user-select: None;
}

table#foobar-table,
table#foobar-table > thead > tr > th,
table#foobar-table > tbody > tr > td {
    border: Solid 1px #888888;
    padding: 5px 8px 5px 8px;
    color: #000000;
}

table#foobar-table > thead > tr {
    background-color: rgba(255, 174, 94, 0.8);
    cursor: Pointer;
}

table#foobar-table > tbody > tr:nth-child(even) {
    background-color: #FFFFFF;
}

table#foobar-table > tbody > tr:nth-child(odd) {
    background-color: #FFD2A6;
}

table#foobar-table th[data-type="number"]:hover,
table#foobar-table th[data-type="string"]:hover {
    cursor: Pointer;
}

.upArrow::after {
    content: "\2191";
    color: #FFFFFF;
    position: absolute;
}

.dnArrow::after {
    content: "\2193";
    color: #FFFFFF;
    position: absolute;
}

</style>
