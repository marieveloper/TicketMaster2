<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          crossorigin="anonymous"/>


    <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>


<hr/>
<div class="container">
    <br/><br/>
    <a th:href="@{/createTicket}" class="btn btn-primary">Create Ticket âž• <p class="plus"></p></a>
    <br/><br/>
    <table class="table table-bordered table-striped" id="ticketTable">
        <thead>
        <tr>
            <th datatype="string" id="1">Incident</th>
            <th datatype="date" id="2">Date</th>
            <th datatype="string" id="3">Prioritization</th>
            <th datatype="string" id="4">Admin </th>
            <th datatype="string" id="5">Status</th>
        </tr>
        <tbody>
        <tr th:each="ticket: ${tickets}">
            <td th:text="${ticket.getCategorization()}"/>
            <td th:text="${ticket.getDate()}"/>
            <td th:text="${ticket.getPrio()}"/>
            <td th:text="${ticket.getUser().getUsername()}"/>
            <td th:text="${ticket.getStatus()}"/>
        </tr>
        </tbody>
    </table>
</div>
</body>

<script>
    // HTML-Tabelle sortieren

    const table = document.getElementById("foobar-table");
    const headers = table.querySelectorAll("th");
    const tableBody = table.querySelector("tbody");
    const rows = tableBody.querySelectorAll("tr");
    const directions = Array.from(headers).map(function(header) {
        return "";
    });

    const transform = function(index, content) {
        const type = headers[index].getAttribute("data-type");
        switch (type) {
            case "number":
                return parseFloat(content);
            case "string":
            default:
                return content;
        }
    };

    const sortColumn = function(index, headers) {

        const cls = ["upArrow", "dnArrow"];
        headers.forEach((header) => {
            document.getElementById(header.id).classList.remove(...cls);
        });

        const direction = directions[index] || "asc";
        const multiplier = (direction === "asc") ? 1 : -1;
        const newRows = Array.from(rows);

        if (direction === "asc") {
            document.getElementById(index).classList.add("upArrow");
        }
        else {
            document.getElementById(index).classList.add("dnArrow");
        }

        newRows.sort((rowA, rowB) => {
            const cellA = rowA.querySelectorAll("td")[index].textContent.toLowerCase();
            const cellB = rowB.querySelectorAll("td")[index].textContent.toLowerCase();

            const a = transform(index, cellA);
            const b = transform(index, cellB);

            switch (true) {
                case a > b: return 1 * multiplier;
                case a < b: return -1 * multiplier;
                case a === b: return 0;
            }
        });

        [].forEach.call(rows, function(row) {
            tableBody.removeChild(row);
        });

        directions[index] = direction === "asc" ? "desc" : "asc";
        newRows.forEach(function(newRow) {
            tableBody.appendChild(newRow);
        });
    };

    [].forEach.call(headers, function(header, index) {
        header.setAttribute("id", index);
        header.addEventListener("click", () => {
            sortColumn(index, headers);
        });
    });
</script>
</html>

<style>* {
    box-sizing: border-box;
}

#headline{
    max-width: 1000px;
    max-height: 750px;
    text-align: right;
}


body {
    position: center;
    margin: 0 auto;
    background-color: white;
    text-align: left;
}

.btn-primary{
    background: white;
}


.notification {
    width: 57px;
    height: 57px;
    background: url("../static/images/notification.png");
    background-repeat: no-repeat;
    background-position: center center;
    background-size: cover;
    float: right;
}

.filterButton {
    width: 59px;
    height: 59px;
    background: url("../static/images/filterButton.png");
    background-repeat: no-repeat;
    background-position: center center;
    background-size: cover;
    opacity: 1;
    position: absolute;
    top: 65px;
    left: 353px;
    overflow: hidden;
}


.userButton {
    width: 57px;
    height: 57px;
    background: url("../static/images/userButton.png");
    background-size: cover;


}

.upArrow::after {
    content: "\2191";
    color: #FFFFFF;
    position: absolute;
}

.dnArrow::after {
    content: "\2193";
    color: #FFFFFF;
    position: absolute;
}
</style>
