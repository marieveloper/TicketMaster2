<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/static/adminDashboardCss.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          crossorigin="anonymous"/>


    <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>


<hr/>
<div class="container">
    <br/><br/>
    <hr/>
    <a th:href="@{/createTicket}" class="btn btn-primary">Create Ticket âž• <p class="plus"></p></a>

    <div class="dropdown">
        <button class="dropbtn"><img src="/static/images/filterButton.png"></button>
        <div class="dropdown-content">
            <a href="#">Status :after</a>
            <a href="#">Admin</a>
            <a href="#">User</a>
            <a href="#">Priorization</a>
            <a href="#">Incident</a>
        </div>
    </div>

    <div type="button" class="userbutton"><img src="/static/images/userButton.png"></div>
    <div type="button" class="notification"><img src="/static/images/notification.png"></div>

    <br><br>
    <table class="table table-bordered table-striped" id="ticketTable">
        <thead>
        <tr>
            <th datatype="string" id="1" class="dnArrow">Incident</th>
            <th datatype="date" id="2" class="dnArrow">Date</th>
            <th datatype="string" id="3" class="dnArrow">Prioritization</th>
            <th datatype="string" id="4" class="dnArrow">Admin</th>
            <th datatype="string" id="5" class="dnArrow">Status</th>
        </tr>
        <tbody>
        <tr th:each="ticket: ${tickets}">
            <td th:text="${ticket.getCategorization()}"/>
            <td th:text="${ticket.getDate()}"/>
            <td th:text="${ticket.getPrio()}"/>
            <td th:text="${ticket.getUser().getUsername()}"/>
            <td th:text="${ticket.getStatus()}"/>
        </tr>
        </tbody>
    </table>
</div>
</body>

<script>
    // HTML-Tabelle sortieren

    const table = document.getElementById("foobar-table");
    const headers = table.querySelectorAll("th");
    const tableBody = table.querySelector("tbody");
    const rows = tableBody.querySelectorAll("tr");
    const directions = Array.from(headers).map(function (header) {
        return "";
    });

    const transform = function (index, content) {
        const type = headers[index].getAttribute("data-type");
        switch (type) {
            case "number":
                return parseFloat(content);
            case "string":
            default:
                return content;
        }
    };

    const sortColumn = function (index, headers) {

        const cls = ["upArrow", "dnArrow"];
        headers.forEach((header) => {
            document.getElementById(header.id).classList.remove(...cls);
        });

        const direction = directions[index] || "asc";
        const multiplier = (direction === "asc") ? 1 : -1;
        const newRows = Array.from(rows);

        if (direction === "asc") {
            document.getElementById(index).classList.add("upArrow");
        } else {
            document.getElementById(index).classList.add("dnArrow");
        }

        newRows.sort((rowA, rowB) => {
            const cellA = rowA.querySelectorAll("td")[index].textContent.toLowerCase();
            const cellB = rowB.querySelectorAll("td")[index].textContent.toLowerCase();

            const a = transform(index, cellA);
            const b = transform(index, cellB);

            switch (true) {
                case a > b:
                    return 1 * multiplier;
                case a < b:
                    return -1 * multiplier;
                case a === b:
                    return 0;
            }
        });

        [].forEach.call(rows, function (row) {
            tableBody.removeChild(row);
        });

        directions[index] = direction === "asc" ? "desc" : "asc";
        newRows.forEach(function (newRow) {
            tableBody.appendChild(newRow);
        });
    };

    [].forEach.call(headers, function (header, index) {
        header.setAttribute("id", index);
        header.addEventListener("click", () => {
            sortColumn(index, headers);
        });
    });
</script>
</html>

<style>* {
    box-sizing: border-box;
}


body {
    position: center;
    margin: 0 auto;
    background-color: white;
    text-align: left;
}


.btn-primary {
    background: white;
}

.upArrow::after {
    content: "\2191";
    color: #FFFFFF;
    position: absolute;
}

.dnArrow::after {
    content: "\2193";
    color: #FFFFFF;
    position: absolute;
}



.dropdown-content a {
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown-content a:hover {
    background-color: #ddd;
}

.dropdown:hover .dropdown-content {
    display: block;
}

.dropdown:hover .dropbtn {
    background-color: white;
}

button{

}

</style>
